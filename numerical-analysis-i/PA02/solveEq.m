% Input: matrix LU decomposed in a lower and upper matrix%               b  right hand side of the system of linear equations%               z  the permutation vector from luDecompositionfunction [x] = solveEq(LU,b,z)n = length(LU);x = zeros(n,1);Pb = b(z);% Solving Ly = Pb% initialise row vectory = zeros(1,n);for i=1:n   y(i) = Pb(i);   for j=1:i-1      y(i) = y(i)-LU(i,j)*y(j);   endend% Solving Rx = yx(n) = y(n) / LU(n,n);for k=n-1:-1:1   x(k) = y(k);   for j=k+1:n      x(k) = x(k) - LU(k,j)*x(j);   end   x(k) = x(k) / LU(k,k);endend